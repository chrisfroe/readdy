sudo: false
language: cpp
compiler:
  - gcc
  - clang
os:
 - linux
 - osx
osx_image: xcode7
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - llvm-toolchain-precise-3.7
    packages:
    - clang-3.7
    - g++-5
    - gcc-5

env:
  global:
    - PATH=$HOME/_cmake/bin:$HOME/miniconda/bin:$PATH
  matrix:
    - python=2.7
      CONDA_PY=27
    - python=3.5
      CONDY_PY=35

cache:
  directories:
    - $home/.readdy_cache/boost_dl_job_${TRAVIS_JOB_NUMBER##*.}

before_install:
- tools/ci/travis/setup_travis.sh
- tools/ci/travis/install_miniconda.sh
- conda config --set always_yes true
- conda config --add channels omnia
- conda install -q conda-build
- export READDY_INSTALL_UNIT_TEST_EXECUTABLE=1
- export BOOST_DOWNLOAD_CACHE_DIR=$HOME/.readdy_cache/boost_dl

install:
- if [ "$CXX" = "g++" ]; then export CXX="g++-5" CC="gcc-5"; fi
- if [[ "${TRAVIS_OS_NAME}" == "linux" ]] && [ "$CXX" = "clang++" ]; then export CXX="clang++-3.7" CC="clang-3.7"; fi

script:
- conda build -q tools/conda-recipe
